import{_ as t,c as p,a,d as s,e as o,b as i,r as l,o as c}from"./app-C1uG88mu.js";const r={},u={id:"preferences-updated",tabindex:"-1"},d={class:"header-anchor",href:"#preferences-updated"};function k(v,n){const e=l("Badge");return c(),p("div",null,[n[1]||(n[1]=a(`<h1 id="webhooks" tabindex="-1"><a class="header-anchor" href="#webhooks"><span>Webhooks</span></a></h1><h2 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h2><p>The ID Service Webhooks notifies your application when a user revokes authorization for a platform or their entire account on OWN3D ID or when a user changes their personal information and preferences. This documentation provides a detailed guide on how developers can implement the webhook and validate the timestamp and signature using example code.</p><h2 id="table-of-contents" tabindex="-1"><a class="header-anchor" href="#table-of-contents"><span>Table of Contents</span></a></h2><ol><li><a href="#webhook-overview">Webhook Overview</a></li><li><a href="#webhook-payload">Webhook Payload</a></li><li><a href="#security">Security</a></li><li><a href="#implementation-steps">Implementation Steps</a></li><li><a href="#example-code">Example Code</a></li><li><a href="#error-handling">Error Handling</a></li><li><a href="#testing">Testing</a></li><li><a href="#faqs">FAQs</a></li></ol><h2 id="webhook-overview" tabindex="-1"><a class="header-anchor" href="#webhook-overview"><span>Webhook Overview</span></a></h2><p>The webhook is triggered when a user revokes authorization for a platform or their entire account. OWN3D ID will send an HTTP POST request to the configured webhook URL with the relevant payload.</p><h2 id="webhook-payload" tabindex="-1"><a class="header-anchor" href="#webhook-payload"><span>Webhook Payload</span></a></h2><p>The payload sent to the webhook URL will be in one of the following formats:</p><h3 id="account-migration" tabindex="-1"><a class="header-anchor" href="#account-migration"><span>Account Migration</span></a></h3><p>This payload is sent when a user migrates their account to a new platform.</p><ul><li>This event implies a <code>platform_authorization_revoked</code> event for the old user id.</li></ul><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;account_migration&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;old_user_id&quot;</span><span class="token operator">:</span> <span class="token number">1337</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;new_user_id&quot;</span><span class="token operator">:</span> <span class="token number">1338</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;connections&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token property">&quot;platform&quot;</span><span class="token operator">:</span> <span class="token string">&quot;twitch&quot;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token property">&quot;platform_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example_platform_id&quot;</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="account-authorization-revoked" tabindex="-1"><a class="header-anchor" href="#account-authorization-revoked"><span>Account Authorization Revoked</span></a></h3><p>This payload is sent when a user revokes authorization for their entire account.</p><p>If OWN3D ID is your only OAuth client, you can use this event to delete the user&#39;s data from your system.</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;account_authorization_revoked&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token number">1337</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;client_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example_client_id&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="platform-authorization-revoked" tabindex="-1"><a class="header-anchor" href="#platform-authorization-revoked"><span>Platform Authorization Revoked</span></a></h3><p>This payload is sent when a user revokes authorization for a specific platform. Platforms include Streaming services like Twitch and YouTube. Also, other services like Discord, TikTok and Facebook.</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;platform_authorization_revoked&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token number">1337</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;platform&quot;</span><span class="token operator">:</span> <span class="token string">&quot;twitch&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;platform_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example_platform_id&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;initiated_by&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user&quot;</span> <span class="token comment">// platform</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>initiated_by</code> Field: This field clearly indicates who initiated the revocation, allowing your system to handle the revocation appropriately. If the value is <code>platform</code>, it suggests that the platform might have forced the disconnection due to password changes, technical issues, or other reasons, and you might want to consider temporary acknowledgment. If the value is <code>user</code>, it means the user has manually revoked the authorization, which might indicate a potential account deletion or a change in user preference.</p><h3 id="platform-linked" tabindex="-1"><a class="header-anchor" href="#platform-linked"><span>Platform Linked</span></a></h3><p>This payload is sent when a user links a platform to their account.</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;platform_linked&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token number">1337</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;platform&quot;</span><span class="token operator">:</span> <span class="token string">&quot;twitch&quot;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;platform_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;example_platform_id&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="personal-information-updated" tabindex="-1"><a class="header-anchor" href="#personal-information-updated"><span>Personal Information Updated</span></a></h3><p>This payload is sent when a user updates their personal information like name and email.</p><p>Currently, this webhook is triggered for the following changes: <code>name</code>, <code>email</code>, <code>permissions</code>.</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;personal_information_updated&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token number">1337</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;user&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// contains values that have been updated</span></span>
<span class="line">      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;OWN3D_QA1&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;developers@example.com&quot;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,28)),s("h3",u,[s("a",d,[s("span",null,[n[0]||(n[0]=o("Preferences Updated ",-1)),i(e,{text:"WIP",type:"warning"})])])]),n[2]||(n[2]=a(`<p>This payload is sent when a user updates their preferences.</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;preferences_updated&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;user_id&quot;</span><span class="token operator">:</span> <span class="token number">1337</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;preferences&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// contains kv values that have been updated</span></span>
<span class="line">      <span class="token property">&quot;foo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;marketing_emails&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="security" tabindex="-1"><a class="header-anchor" href="#security"><span>Security</span></a></h2><p>To ensure the security of the webhook, each request includes the following headers:</p><ul><li><code>X-Signature</code>: A HMAC SHA-256 signature of the payload and timestamp.</li><li><code>X-Timestamp</code>: The UNIX timestamp of when the request was made.</li></ul><p>The signature is generated using the client&#39;s secret. The timestamp ensures the request is recent and prevents replay attacks.</p><h2 id="implementation-steps" tabindex="-1"><a class="header-anchor" href="#implementation-steps"><span>Implementation Steps</span></a></h2><ol><li><strong>Receive the Request</strong>: Capture the incoming HTTP POST request and extract the headers and payload.</li><li><strong>Validate the Timestamp</strong>: Check if the timestamp is within an acceptable range (e.g., 5 minutes).</li><li><strong>Generate the Signature</strong>: Recreate the signature using the received payload and timestamp.</li><li><strong>Verify the Signature</strong>: Compare the generated signature with the received signature to ensure authenticity.</li><li><strong>Process the Request</strong>: If all validations pass, proceed with processing the authorization revocation request.</li></ol><h2 id="example-code" tabindex="-1"><a class="header-anchor" href="#example-code"><span>Example Code</span></a></h2><p>Below is an example implementation in PHP without any framework:</p><div class="language-php line-numbers-mode" data-highlighter="prismjs" data-ext="php"><pre><code class="language-php"><span class="line"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span></span>
<span class="line"><span class="token comment">// Configure your client secret</span></span>
<span class="line"><span class="token variable">$clientSecret</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;your_client_secret&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Function to validate the timestamp</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function-definition function">isValidTimestamp</span><span class="token punctuation">(</span><span class="token variable">$timestamp</span><span class="token punctuation">,</span> <span class="token variable">$tolerance</span> <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$currentTimestamp</span> <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">abs</span><span class="token punctuation">(</span><span class="token variable">$currentTimestamp</span> <span class="token operator">-</span> <span class="token variable">$timestamp</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token variable">$tolerance</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Function to validate the signature</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function-definition function">isValidSignature</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">,</span> <span class="token variable">$timestamp</span><span class="token punctuation">,</span> <span class="token variable">$receivedSignature</span><span class="token punctuation">,</span> <span class="token variable">$clientSecret</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$timestamp</span> <span class="token operator">.</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$calculatedSignature</span> <span class="token operator">=</span> <span class="token function">hash_hmac</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;sha256&#39;</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$clientSecret</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">hash_equals</span><span class="token punctuation">(</span><span class="token variable">$calculatedSignature</span><span class="token punctuation">,</span> <span class="token variable">$receivedSignature</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Capture the incoming request</span></span>
<span class="line"><span class="token variable">$headers</span> <span class="token operator">=</span> <span class="token function">getallheaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$input</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">&#39;php://input&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Extract headers</span></span>
<span class="line"><span class="token variable">$receivedSignature</span> <span class="token operator">=</span> <span class="token variable">$headers</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;X-Signature&#39;</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string single-quoted-string">&#39;&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$timestamp</span> <span class="token operator">=</span> <span class="token variable">$headers</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;X-Timestamp&#39;</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Validate the timestamp</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isValidTimestamp</span><span class="token punctuation">(</span><span class="token variable">$timestamp</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">http_response_code</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;error&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Invalid timestamp&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">exit</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Validate the signature</span></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isValidSignature</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">,</span> <span class="token variable">$timestamp</span><span class="token punctuation">,</span> <span class="token variable">$receivedSignature</span><span class="token punctuation">,</span> <span class="token variable">$clientSecret</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">http_response_code</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;error&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Invalid signature&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">exit</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// Process the authorization revocation request</span></span>
<span class="line"><span class="token variable">$type</span> <span class="token operator">=</span> <span class="token variable">$payload</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$payload</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;data&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token variable">$userId</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;user_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$type</span> <span class="token operator">===</span> <span class="token string single-quoted-string">&#39;platform_authorization_revoked&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$platformId</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;platform_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token variable">$platform</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;platform&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Implement your platform authorization revocation logic here</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token variable">$type</span> <span class="token operator">===</span> <span class="token string single-quoted-string">&#39;account_authorization_revoked&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token variable">$clientId</span> <span class="token operator">=</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;client_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token comment">// Implement your account authorization revocation logic here</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">http_response_code</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;error&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;Invalid payload type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token keyword">exit</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token function">http_response_code</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;status&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;success&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token delimiter important">?&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="error-handling" tabindex="-1"><a class="header-anchor" href="#error-handling"><span>Error Handling</span></a></h2><p>Ensure that your implementation handles errors gracefully:</p><ul><li><strong>Invalid Timestamp</strong>: Respond with HTTP 400 status and an error message.</li><li><strong>Invalid Signature</strong>: Respond with HTTP 403 status and an error message.</li><li><strong>Invalid Payload Type</strong>: Respond with HTTP 400 status and an error message.</li><li><strong>Processing Errors</strong>: Respond with HTTP 500 status and an error message.</li></ul><h2 id="testing" tabindex="-1"><a class="header-anchor" href="#testing"><span>Testing</span></a></h2><p>To test your implementation, you can use tools like Postman to send POST requests with the appropriate payload and headers. Verify that your webhook correctly processes valid requests and handles invalid ones appropriately.</p><h2 id="faqs" tabindex="-1"><a class="header-anchor" href="#faqs"><span>FAQs</span></a></h2><h3 id="how-do-i-get-the-client-secret" tabindex="-1"><a class="header-anchor" href="#how-do-i-get-the-client-secret"><span>How do I get the client secret?</span></a></h3><p>The client secret is provided when you register your OAuth client with OWN3D.</p><h3 id="what-if-the-request-is-not-from-own3d" tabindex="-1"><a class="header-anchor" href="#what-if-the-request-is-not-from-own3d"><span>What if the request is not from OWN3D?</span></a></h3><p>If the signature validation fails, you should reject the request with a 403 status code.</p><h3 id="can-i-use-a-framework" tabindex="-1"><a class="header-anchor" href="#can-i-use-a-framework"><span>Can I use a framework?</span></a></h3><p>While this documentation provides a framework-less example, you can implement similar logic in any PHP framework by following the same principles.</p><hr><p>For further assistance, please contact OWN3D Developer support.</p>`,25))])}const h=t(r,[["render",k]]),b=JSON.parse('{"path":"/docs/id/webhooks.html","title":"Webhooks","lang":"en-US","frontmatter":{},"git":{},"filePathRelative":"docs/id/webhooks.md"}');export{h as comp,b as data};
